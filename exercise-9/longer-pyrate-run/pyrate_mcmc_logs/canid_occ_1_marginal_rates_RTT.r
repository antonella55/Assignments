# 1 files combined:
# 	/home/eeb177-student/Desktop/EEB-177/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/EEB-177/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.180094140813, 0.180094140813,0.180094140813,0.180094140813,0.0733535523197,0.0556306164688,0.0419395599939,0.0447777423416,0.0456038677668,0.0442451472569,0.0439259485343,0.0442451472569,0.0439259485343,0.0439259485343,0.0439259485343,0.0454741947046,0.0447777423416,0.0447777423416,0.0454741947046,0.0562154682577,0.0905386512032,0.0925472782161,0.0932318940594,0.0902689452642,0.0890861245778,0.0907317570814,0.0902689452642,0.0855441783059,0.0855441783059,0.0855441783059,0.0840795377863,0.119801801999,0.134798797119,0.136906731495,0.143462128677,0.142751137751,0.142751137751,0.136265141405,0.124505421493,0.113907138359,0.111435245453,0.111435245453,0.112036061346,0.10642223781,0.107923284966,0.102592885012,0.102329788301,0.0915137186778,0.0915137186778,0.088289086487,0.088289086487)
L_hpd_M95=c(0.357683967, 0.357683967,0.357683967,0.357683967,0.33178900585,0.313063893262,0.236800108285,0.125036847758,0.125036847758,0.12292919225,0.12292919225,0.12292919225,0.12292919225,0.12292919225,0.12292919225,0.125874336105,0.133000942174,0.138722782716,0.163335644689,0.215004137521,0.222780700698,0.221866778959,0.221553304249,0.217909876008,0.213517441253,0.21325821721,0.213735216899,0.210764763093,0.21201313417,0.221685426757,0.332669312308,0.408653185236,0.422557427612,0.423473481685,0.43415720282,0.43415720282,0.436375012798,0.43415720282,0.428376029938,0.422557427612,0.422557427612,0.426275868602,0.429298577546,0.429298577546,0.437241161231,0.456868750811,0.48922425152,0.496005897276,0.500209778793,0.497656256403,0.497656256403)
M_hpd_m95=c(0.864467647087, 0.864467647087,0.0806173451803,0.0806173451803,0.0805158783958,0.0815235070756,0.0819437698214,0.0804092015427,0.0806973148009,0.0815235070756,0.0817953320812,0.0825321530823,0.0814629963459,0.0805158783958,0.0815235070756,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0804092015427,0.0711409006048,0.0612938589234,0.0592361816309,0.0592361816309,0.0612938589234,0.0621223746754,0.0618552083872,0.0618552083872,0.0617359929349,0.054086435166,0.054086435166,0.0499237546357,0.0491590969276,0.0418335951613,0.033444111985,0.0322059471499,0.020847320615,0.0285538429933,0.0260699540443,0.0326071805175,0.0322059471499,0.0322059471499,0.0322059471499,0.0322059471499,0.0322059471499,0.0322059471499)
M_hpd_M95=c(1.49371298416, 1.49371298416,0.153603120765,0.153603120765,0.152996877452,0.152996877452,0.146280276283,0.135644162693,0.131451757217,0.130127057551,0.126347801469,0.126347801469,0.124678318814,0.122735344965,0.12310699331,0.121897075727,0.121897075727,0.121897075727,0.121897075727,0.121897075727,0.121897075727,0.121897075727,0.121897075727,0.122404572488,0.12511376173,0.126347801469,0.126347801469,0.125504722503,0.125504722503,0.126347801469,0.125504722503,0.12522575884,0.12522575884,0.123840787687,0.124170145268,0.12575448312,0.123840787687,0.12575448312,0.12575448312,0.126347801469,0.130491549992,0.152471813331,0.163237410663,0.163449965109,0.186515335613,0.188654758562,0.188654758562,0.188654758562,0.188654758562,0.188654758562,0.188654758562)
R_hpd_m95=c(-1.27474777767, -1.27474777767,0.0550427660206,0.0550427660206,-0.0334127844394,-0.0638010978547,-0.0977120811046,-0.0830898952547,-0.0802821898702,-0.0771101494228,-0.0741981021367,-0.0704419268458,-0.0704419268458,-0.0704419268458,-0.0703157652281,-0.0704419268458,-0.0684963869366,-0.0705782924447,-0.070165227763,-0.0520762595564,-0.0144451050339,-0.0143409403995,-0.0174726574263,-0.0177275471384,-0.0153498530861,-0.0174726574263,-0.0177275471384,-0.0188800616207,-0.0174726574263,-0.0184354983628,-0.0177275471384,0.020948077545,0.0312773241271,0.0361841970271,0.04618586109,0.04618586109,0.0361841970271,0.0312773241271,0.020745668605,0.0131188233353,0.0157063050734,-0.0228929071773,-0.0256493976986,-0.0173430493842,-0.0256493976986,-0.0298359887291,-0.0360565163009,-0.0678254267554,-0.0612403606565,-0.0638010978547,-0.0638010978547)
R_hpd_M95=c(-0.620752672962, -0.620752672962,0.25466015286,0.25466015286,0.23108084452,0.220586239022,0.14582452454,0.0312639153254,0.0269676615864,0.0261726847702,0.0253736970724,0.0267165080543,0.0257242137605,0.0247830340106,0.0242115289002,0.0257242137605,0.0354339233698,0.0385468754885,0.060565732947,0.114741196307,0.126672912482,0.123811639185,0.118910419993,0.117597279042,0.117597279042,0.118910419993,0.124371334411,0.12667253749,0.129508214524,0.135899009944,0.243226698147,0.31556963465,0.323863376014,0.327568426022,0.342537915982,0.342537915982,0.338060766356,0.337699147454,0.336101742765,0.338060766356,0.350323284435,0.338060766356,0.336737768329,0.350598088305,0.35731540963,0.385497033851,0.419160346008,0.397365170007,0.409639340499,0.408853408232,0.408853408232)
L_mean=c(0.261891971097, 0.261891971097,0.261850265014,0.261850265014,0.246207355794,0.194284133289,0.0917499794331,0.0764255706709,0.0760910226653,0.0760126776402,0.076097552802,0.0761578849635,0.0761686683058,0.0762262788327,0.0762348708911,0.0767017200315,0.0790447523627,0.0805715450483,0.0875628875026,0.140611230383,0.159747107085,0.160505941069,0.160346677232,0.159710489742,0.157549860256,0.155560421512,0.153923100837,0.153203893826,0.153563558883,0.156142566922,0.189990692647,0.255608401272,0.269216764276,0.277194152009,0.289953104697,0.288837234156,0.287131818624,0.285099221645,0.28336472184,0.279092730665,0.277158109741,0.275333959577,0.273962728688,0.273925364265,0.275073807044,0.281252336062,0.284097668511,0.283878448886,0.284222748668,0.284310877165,0.284244153163)
M_mean=c(1.16880572027, 1.16880572027,0.110892996666,0.110895241784,0.110803820141,0.110567018558,0.108577941733,0.106639992951,0.105553018992,0.104901083379,0.10392098804,0.103598900257,0.103366081088,0.103030143507,0.102867203963,0.102728558188,0.102728558188,0.102730637648,0.102730637648,0.102730637648,0.102730637648,0.102730637648,0.102730637648,0.102432249926,0.101183845831,0.09958594225,0.0985395807329,0.0983965890024,0.0984035579758,0.098481600087,0.0985660627818,0.0985656458426,0.0986038528726,0.0987686499622,0.0975076182252,0.0970659296866,0.0967993161692,0.0969168754848,0.0973936664265,0.0980530712022,0.0991773459483,0.103574830929,0.103825977822,0.104270690625,0.106566286328,0.107419328432,0.107419328432,0.107419328432,0.107419328432,0.107419328432,0.107419328432)
R_mean=c(-0.906913749172, -0.906913749172,0.150957268348,0.15095502323,0.135403535652,0.083717114731,-0.0168279623004,-0.0302144222802,-0.0294619963265,-0.0288884057391,-0.027823435238,-0.0274410152935,-0.027197412782,-0.0268038646739,-0.0266323330722,-0.0260268381569,-0.0236838058257,-0.0221590925996,-0.0151677501452,0.0378805927354,0.0570164694368,0.0577753034216,0.0576160395842,0.0572782398165,0.0563660144254,0.0559744792619,0.0553835201045,0.0548073048233,0.055160000907,0.0576609668347,0.0914246298652,0.157042755429,0.170612911403,0.178425502047,0.192445486472,0.191771304469,0.190332502454,0.18818234616,0.185971055413,0.181039659463,0.177980763792,0.171759128648,0.170136750866,0.16965467364,0.168507520716,0.173833007631,0.17667834008,0.176459120454,0.176803420236,0.176891548734,0.176824824732)
trans=0.5
age=(0:(51-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.550230756672), xlim = c(-53.55,2.55), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.64308428258), xlim = c(-53.55,2.55), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.40222255544, 0.461076380609), xlim = c(-53.55,2.55), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-53.55,2.55), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()