# 1 files combined:
# 	/home/eeb177-student/Desktop/EEB-177/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/EEB-177/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.134647442343, 0.134647442343,0.134647442343,0.134647442343,0.13974580164,0.0735656319696,0.0583456682639,0.055806269025,0.0608193148192,0.0608193148192,0.0583456682639,0.0583456682639,0.0583456682639,0.0583456682639,0.0583456682639,0.0663283335853,0.0663283335853,0.0670004534064,0.0749419201056,0.0749419201056,0.081633624553,0.103582579471,0.103582579471,0.103582579471,0.103582579471,0.103582579471,0.103582579471,0.103582579471,0.103582579471,0.107380810234,0.103582579471,0.116222906896,0.12889185615,0.140566967115,0.140566967115,0.140566967115,0.140566967115,0.140566967115,0.140566967115,0.140566967115,0.140566967115,0.1338382428,0.1338382428,0.105099481416,0.105099481416,0.119580316975,0.105099481416,0.109990033119,0.109990033119,0.105099481416,0.105099481416,0.105099481416,0.105099481416,0.105099481416)
L_hpd_M95=c(0.332376941529, 0.332376941529,0.332376941529,0.332376941529,0.351867401497,0.32926938074,0.264556535935,0.166380067569,0.160060124817,0.160060124817,0.156176636037,0.156176636037,0.156176636037,0.156176636037,0.156176636037,0.162546390186,0.167758386868,0.176554428001,0.181195539798,0.191037632709,0.206785736638,0.217913750163,0.217913750163,0.220557461707,0.217913750163,0.217913750163,0.217913750163,0.217913750163,0.234247914152,0.255759453185,0.274795895985,0.381726277058,0.409797168988,0.409797168988,0.409797168988,0.409797168988,0.417725438353,0.417725438353,0.422964248289,0.438412005168,0.440949724297,0.430022701116,0.430022701116,0.417725438353,0.417725438353,0.440949724297,0.429991901148,0.449875403395,0.449875403395,0.449875403395,0.449875403395,0.449875403395,0.449875403395,0.449875403395)
M_hpd_m95=c(0.799952019826, 0.799952019826,0.0975338529436,0.0975338529436,0.0975338529436,0.0975338529436,0.0975338529436,0.0975338529436,0.0940410321875,0.0940410321875,0.0940410321875,0.0879944515261,0.0893742007823,0.0879944515261,0.0800890132403,0.0831660905044,0.0784066500508,0.0805081827928,0.0800890132403,0.0805081827928,0.0805081827928,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0813511799882,0.0734464621409,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508,0.0784066500508)
M_hpd_M95=c(1.46261033387, 1.46261033387,0.171209226206,0.171209226206,0.171209226206,0.170492031072,0.170492031072,0.170492031072,0.166617414404,0.165767058263,0.165767058263,0.159986536089,0.159986536089,0.158279023393,0.151867609565,0.151867609565,0.138877779841,0.130124313242,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.128249276372,0.129280353353,0.129280353353,0.129280353353,0.129280353353,0.129280353353,0.129280353353,0.132050585614,0.185544739222,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675,0.198142599675)
R_hpd_m95=c(-1.22871559264, -1.22871559264,-0.000618307281791,-0.000618307281791,-0.0012115132586,-0.0617422464795,-0.0924988945168,-0.0924988945168,-0.0846296189264,-0.0846296189264,-0.0846296189264,-0.0846296189264,-0.0846296189264,-0.0816276001134,-0.069388260902,-0.0686105339737,-0.0617422464795,-0.052316395961,-0.0389030912607,-0.0346682106432,-0.0272882117442,-0.00430586149011,-0.0025203884811,-0.00430586149011,-0.0025203884811,-0.0025203884811,-0.0025203884811,-0.00430586149011,-0.0025203884811,-0.0025203884811,0.00663407578009,0.00741542970636,0.0194505539531,0.0263268735038,0.0316397771897,0.0316397771897,0.0316397771897,0.0316397771897,0.0263268735038,0.00309017971878,0.00309017971878,0.00990103638096,0.00990103638096,0.00309017971878,0.00309017971878,-0.0672838510465,-0.0527068536504,-0.0672838510465,-0.0672838510465,-0.0686615779937,-0.0686615779937,-0.0686615779937,-0.0686615779937,-0.0686615779937)
R_hpd_M95=c(-0.577367851081, -0.577367851081,0.218356008048,0.218356008048,0.232754780355,0.200161680586,0.144256123203,0.0632150121948,0.0362253779144,0.0401647657829,0.0419856864551,0.0401647657829,0.0401647657829,0.0444775796087,0.0444775796087,0.0473759211603,0.0592043501679,0.069584003023,0.0872811403105,0.0960389013595,0.104199671306,0.109232223793,0.114379590832,0.114379590832,0.114473239283,0.114473239283,0.114473239283,0.114473239283,0.127228429511,0.155216743083,0.183889290709,0.275459260795,0.304243578786,0.304243578786,0.312116991034,0.312116991034,0.317070904465,0.317070904465,0.317070904465,0.317070904465,0.317070904465,0.317070904465,0.317070904465,0.33657443232,0.33657443232,0.285230731323,0.310185455126,0.306040413374,0.306040413374,0.306040413374,0.306040413374,0.306040413374,0.306040413374,0.306040413374)
L_mean=c(0.253870652764, 0.253870652764,0.253870652764,0.253870652764,0.249544960442,0.227022967397,0.126512313556,0.104981971336,0.100474962014,0.100474962014,0.100119456342,0.100119456342,0.100119456342,0.100111441157,0.100338195448,0.101376319448,0.111735091462,0.118146890142,0.12761107987,0.139325902813,0.147399401755,0.16088518583,0.161593421973,0.161967592519,0.162883441094,0.162883441094,0.162883441094,0.163009441175,0.165384853362,0.169894514268,0.176488374832,0.230256658075,0.260193519025,0.265555718118,0.267313046749,0.267608460277,0.267069569078,0.267688617238,0.265329839658,0.260890157013,0.256629297654,0.254785185489,0.252598533416,0.251325818287,0.250686261966,0.249535198561,0.249988472386,0.24905688632,0.248307788079,0.249578942197,0.250007486802,0.250007486802,0.250007486802,0.250007486802)
M_mean=c(1.13401835354, 1.13401835354,0.130254122787,0.130254122787,0.130254122787,0.129054220613,0.129054220613,0.129054220613,0.128085080211,0.127561055047,0.127196486317,0.124449689782,0.122671486001,0.120799534595,0.114554748048,0.111514093822,0.108966939782,0.107137053695,0.106522363608,0.106444953428,0.106384495978,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106351445883,0.106480066639,0.106746971632,0.106746971632,0.106746971632,0.106746971632,0.106746971632,0.108349646258,0.114674768246,0.11594434692,0.116037320472,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221,0.116280731221)
R_mean=c(-0.880147700777, -0.880147700777,0.123616529977,0.123616529977,0.119290837655,0.0979687467838,-0.00254190705753,-0.0240722492772,-0.0276101181969,-0.0270860930333,-0.027077029975,-0.02433023344,-0.0225520296588,-0.0206880934384,-0.0142165526005,-0.0101377743732,0.00276815168013,0.0110098364469,0.0210887162617,0.0328809493849,0.0410149057773,0.0545337399464,0.0552419760896,0.0556161466357,0.056531995211,0.056531995211,0.056531995211,0.0566579952918,0.0590334074794,0.0635430683854,0.0701369289486,0.123905212192,0.153842073142,0.159075651479,0.160566075117,0.160861488644,0.160322597446,0.160941645605,0.158582868026,0.152540510755,0.141954529408,0.138840838569,0.136561212944,0.135045087066,0.134405530744,0.13325446734,0.133707741165,0.132776155099,0.132027056858,0.133298210975,0.133726755581,0.133726755581,0.133726755581,0.133726755581)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.494862943735), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.60887136725), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35158715191, 0.370231875552), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()